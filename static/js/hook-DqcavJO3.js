var g=(o,a,l)=>new Promise((i,r)=>{var m=n=>{try{c(l.next(n))}catch(u){r(u)}},f=n=>{try{c(l.throw(n))}catch(u){r(u)}},c=n=>n.done?i(n.value):Promise.resolve(n.value).then(m,f);c((l=l.apply(o,a)).next())});import{t as y,n as h,x as B,b as d,at as M,a8 as v,aA as p,aL as T,aU as S,f as w,r as b,aO as L,af as Y,aW as _}from"./index-D3FY82Rz.js";import{e as $,f as F,h as I}from"./monitor-Ml_QDAkh.js";import{_ as N}from"./description.vue_vue_type_style_index_0_lang-DZHckEZL.js";import{u as O}from"./useBasicLayout-DS6NlR9d.js";const{clipboardValue:V,copied:H}=L(),{isMobile:k}=O();function K(o){const a=y({username:"",status:"",token:"",summary:"",currentPage:1,pageSize:10}),l=h([]),i=h(!0),r=h(0),m=y({total:0,pageSize:10,currentPage:1,pageSizes:[10,20,50,100],background:!0}),f=e=>(a.currentPage-1)*a.pageSize+e+1,c=e=>{V.value=e,H.value&&p("复制成功",{type:"success"})},n=[{label:"列表",type:"selection"},{label:"序号",type:"index",index:f,minWidth:40},{label:"编号",hide:!0,prop:"id"},{label:"用户",prop:"username",minWidth:80,cellRenderer:({row:e})=>d("span",{style:{color:"blue"}},[e.username])},{label:"用户token",prop:"token",minWidth:80,cellRenderer:({row:e})=>{const t=()=>{c(e.token)};return d(b("el-button"),{type:"primary",onClick:t,link:!0},{default:()=>[w("点击复制")]})}},{label:"请求方式",prop:"method",minWidth:80,cellRenderer:({row:e,props:t})=>d(b("el-tag"),{size:t.size,type:e.method=="POST"?"warning":"danger",effect:"dark"},{default:()=>[e.method]})},{label:"API名称",prop:"summary",minWidth:80,cellRenderer:({row:e})=>d("span",{style:{color:"red"}},[e.summary])},{label:"IP地址",prop:"ip",minWidth:100},{label:"状态",prop:"status",minWidth:60,cellRenderer:({row:e,props:t})=>d(b("el-tag"),{size:t.size,type:e.status===200?"success":"danger",effect:"dark"},{default:()=>[e.status===200?"成功":e.status]})},{label:"访问时间",minWidth:150,prop:"create_time",formatter:({create_time:e})=>M(e).format("YYYY-MM-DD HH:mm:ss")},{label:"操作",fixed:"right",width:110,slot:"operation"}];function u(e){F(e.id).then(t=>g(this,null,function*(){t.code===200?(p(`您删除了日志ID为${e.id}的这条数据`,{type:"success"}),yield s()):p(`操作失败，${t.message}`,{type:"error"})}))}function z(e){r.value=e.length,o.value.setAdaptive()}function C(){r.value=0,o.value.getTableRef().clearSelection()}function D(){const e=o.value.getTableRef().getSelectionRows();I(S(e,"id")).then(t=>g(this,null,function*(){t.code===200?(p(`已删除日志编号为 ${S(e,"id")} 的数据`,{type:"success"}),yield s()):p(`操作失败，${t.message}`,{type:"error"}),o.value.getTableRef().clearSelection()}))}function R(e){a.currentPage=1,a.pageSize=e,s()}function W(e){a.currentPage=e,s()}function x(e){T({title:"日志详情",width:"60%",draggable:!0,fullscreen:!!k.value,closeOnClickModal:!0,contentRenderer:()=>Y(N,v(e)),footerButtons:[{label:"关闭",text:!0,size:"large",bg:!0,btnClick:({dialog:{options:t,index:A}})=>{_(t,A)}}]})}function s(){return g(this,null,function*(){i.value=!0;const{data:e}=yield $(v(a));l.value=e.results,m.total=e.total,setTimeout(()=>{i.value=!1},500)})}const P=e=>{e&&(e.resetFields(),s())};return B(()=>{s()}),{form:a,loading:i,columns:n,dataList:l,selectedNum:r,pagination:m,isMobile:k,onbatchDel:D,openDialog:x,onSearch:s,resetForm:P,handleDelete:u,onSelectionCancel:C,handleSizeChange:R,handleCurrentChange:W,handleSelectionChange:z}}export{K as useRole};
