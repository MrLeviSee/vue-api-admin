var f=(a,n,r)=>new Promise((d,s)=>{var c=o=>{try{g(r.next(o))}catch(u){s(u)}},p=o=>{try{g(r.throw(o))}catch(u){s(u)}},g=o=>o.done?d(o.value):Promise.resolve(o.value).then(c,p);g((r=r.apply(a,n)).next())});import{t as x,n as v,x as k,b as m,at as w,a8 as y,aA as h,aL as j,aU as S,r as z,aV as L,af as O,aW as Y}from"./index-D3FY82Rz.js";import{a as $,b as B,c as I}from"./monitor-Ml_QDAkh.js";import{_ as N}from"./description.vue_vue_type_style_index_0_lang-DZHckEZL.js";import{u as V}from"./useBasicLayout-DS6NlR9d.js";function F(a){return typeof a=="function"||Object.prototype.toString.call(a)==="[object Object]"&&!L(a)}const{isMobile:T}=V();function J(a){const n=x({uid:"",status:"",operation:"",module:"",currentPage:1,pageSize:10}),r=[{value:0,text:"其他"},{value:1,text:"修改"},{value:2,text:"添加"},{value:3,text:"删除"},{value:4,text:"登录"},{value:5,text:"上传"}],d=v([]),s=v(!0),c=v(0),p=x({total:0,pageSize:10,currentPage:1,pageSizes:[10,20,50,100],background:!0}),o=[{label:"列表",type:"selection"},{label:"序号",type:"index",index:e=>(n.currentPage-1)*n.pageSize+e+1,minWidth:50},{label:"编号",hide:!0,prop:"id"},{label:"业务模块",prop:"module",minWidth:160,cellRenderer:({row:e})=>m("span",{style:{color:"blue"}},[e.module])},{label:"用户",prop:"uid",minWidth:100},{label:"操作类型",prop:"operation",minWidth:100,cellRenderer:({row:e,props:t})=>{const l=[{value:0,text:""},{value:1,text:null},{value:2,text:"warning"},{value:3,text:"danger"},{value:4,text:"success"},{value:5,text:"info"}],b=r[e.operation].text,_=l[e.operation].text;return m(z("el-tag"),{size:t.size,type:_,effect:"dark"},F(b)?b:{default:()=>[b]})}},{label:"请求方式",prop:"method",minWidth:100,cellRenderer:({row:e})=>{let t="",l="";return l=e.request_params.method,l=="GET"?t="green":l=="POST"?t="#e6a23c":l=="PUT"?t="blue":t="red",m("span",{style:{color:t}},[l])}},{label:"IP地址",prop:"ip",minWidth:100},{label:"状态",prop:"status",minWidth:100,cellRenderer:({row:e,props:t})=>m(z("el-tag"),{size:t.size,type:e.status===0?"danger":"success",effect:"dark"},{default:()=>[e.status===0?"失败":"成功"]})},{label:"访问时间",minWidth:180,prop:"create_time",formatter:({create_time:e})=>w(e).format("YYYY-MM-DD HH:mm:ss")},{label:"操作",fixed:"right",width:110,slot:"operation"}];function u(e){B(e.id).then(t=>f(this,null,function*(){t.code===200?(h(`您删除了日志ID为${e.id}的这条数据`,{type:"success"}),yield i()):h(`操作失败，${t.message}`,{type:"error"})}))}function D(e){c.value=e.length,a.value.setAdaptive()}function W(){c.value=0,a.value.getTableRef().clearSelection()}function A(){const e=a.value.getTableRef().getSelectionRows();I(S(e,"id")).then(t=>f(this,null,function*(){t.code===200?(h(`已删除日志编号为 ${S(e,"id")} 的数据`,{type:"success"}),yield i()):h(`操作失败，${t.message}`,{type:"error"}),a.value.getTableRef().clearSelection()}))}function C(e){n.currentPage=1,n.pageSize=e,i()}function P(e){n.currentPage=e,i()}function R(e){j({title:"日志详情",width:"60%",draggable:!0,fullscreen:!!T.value,fullscreenIcon:!0,closeOnClickModal:!0,contentRenderer:()=>O(N,y(e)),footerButtons:[{label:"关闭",text:!0,size:"large",bg:!0,btnClick:({dialog:{options:t,index:l}})=>{Y(t,l)}}]})}function i(){return f(this,null,function*(){s.value=!0;const{data:e}=yield $(y(n));d.value=e.results,p.total=e.total,setTimeout(()=>{s.value=!1},500)})}const M=e=>{e&&(e.resetFields(),i())};return k(()=>{i()}),{form:n,loading:s,columns:o,dataList:d,selectedNum:c,pagination:p,isMobile:T,onbatchDel:A,openDialog:R,onSearch:i,resetForm:M,handleDelete:u,onSelectionCancel:W,handleSizeChange:C,handleCurrentChange:P,handleSelectionChange:D}}export{J as useRole};
